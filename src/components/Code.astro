---
import shiki, { type Lang } from "shiki";

interface Props {
  language: Lang;
  scaleFactor?: number;
}

const { language, scaleFactor = 1 } = Astro.props;

const code = (await Astro.slots.render("default"))
  .trim()
  .replace(/&lt;/g, "<")
  .replace(/&gt;/g, ">")
  .replace(/&#39;/g, "'")
  .replace(/&quot;/g, '"')
  .replace(/&amp;/g, "&");
const highlighter = await shiki.getHighlighter({ theme: "nord" });
const html = await highlighter.codeToHtml(code, { lang: language });
---

<div
  set:html={html}
  class="my-[3vw] [&_pre]:px-6 [&_pre]:py-3 [&_pre]:rounded-[0.4em] [&_pre]:overflow-scroll [&_pre]:w-max leading-[1.7]"
  style={{ fontSize: 1.75 * scaleFactor + "vw" }}
/>
